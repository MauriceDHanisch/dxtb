"""
Data for testing repulsion taken from https://github.com/grimme-lab/mstore.
"""

import torch

from dxtb.typing import Molecule, Tensor, TypedDict

from ..molecules import merge_nested_dicts, mols


class Refs(TypedDict):
    """Format of reference records containing GFN1-xTB and GFN2-xTB reference values."""

    etot: Tensor
    """Total energy for GFN1-xTB"""

    grad: Tensor
    """Gradients of energy w.r.t. total energy"""


class Record(Molecule, Refs):
    """Store for molecular information and reference values"""


refs: dict[str, Refs] = {
    "H": {"etot": torch.tensor(-4.0142947446183e-01), "grad": torch.tensor([0.0])},
    "H2": {
        "etot": torch.tensor(-1.0362714373390e00),
        "grad": torch.tensor(
            [
                [
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                    +2.1423834012705652e-02,
                ],
                [
                    +0.0000000000000000e00,
                    +0.0000000000000000e00,
                    -2.1423834012705652e-02,
                ],
            ]
        ),
    },
    "H2O": {
        "etot": torch.tensor(-5.7686218257620e00),
        "grad": torch.tensor(
            [
                [
                    -1.2307049910426082e-16,
                    +3.9787374311313613e-17,
                    -7.3676810969652883e-03,
                ],
                [
                    +5.0831225616245086e-04,
                    -4.7887777954429814e-17,
                    +3.6838405484825886e-03,
                ],
                [
                    -5.0831225616232868e-04,
                    +8.1004036431162003e-18,
                    +3.6838405484827161e-03,
                ],
            ]
        ),
    },
    "NO2": {
        "etot": torch.tensor(-1.2409798675060e01),
        "grad": torch.tensor(
            [
                [
                    +2.5452437776221632e-04,
                    -7.1888367755258416e-04,
                    -8.4094732589712947e-03,
                ],
                [
                    -3.9432357031698373e-03,
                    -9.8957701502083214e-03,
                    +4.9644921347522693e-03,
                ],
                [
                    +3.6887113254076244e-03,
                    +1.0614653827760933e-02,
                    +3.4449811242190467e-03,
                ],
            ]
        ),
    },
    "CH4": {
        "etot": torch.tensor(-4.2741992424931e00),
        "grad": torch.tensor(
            [
                [
                    -6.2829515895534982e-17,
                    +1.3205582460873444e-16,
                    +1.8737724045980730e-16,
                ],
                [
                    -2.0411043179948073e-03,
                    -2.0411043179949062e-03,
                    -2.0411043179948967e-03,
                ],
                [
                    +2.0411043179948195e-03,
                    +2.0411043179948043e-03,
                    -2.0411043179948715e-03,
                ],
                [
                    +2.0411043179948915e-03,
                    -2.0411043179948646e-03,
                    +2.0411043179947479e-03,
                ],
                [
                    -2.0411043179948342e-03,
                    +2.0411043179948385e-03,
                    +2.0411043179948368e-03,
                ],
            ]
        ),
    },
    "SiH4": {
        "etot": torch.tensor(-4.0087585461086e00),
        "grad": torch.tensor(
            [
                [
                    +4.0051105877972337e-17,
                    +2.1293053041257504e-16,
                    +1.1814415548302981e-17,
                ],
                [
                    +5.7995736840147491e-03,
                    +5.7995736840147161e-03,
                    -5.7995736840147196e-03,
                ],
                [
                    -5.7995736840147933e-03,
                    -5.7995736840147916e-03,
                    -5.7995736840147794e-03,
                ],
                [
                    +5.7995736840147655e-03,
                    -5.7995736840148557e-03,
                    +5.7995736840147725e-03,
                ],
                [
                    -5.7995736840147517e-03,
                    +5.7995736840147187e-03,
                    +5.7995736840147256e-03,
                ],
            ]
        ),
    },
    "LYS_xao": {
        "etot": torch.tensor(-4.8324739766346e01),
        "grad": torch.tensor(
            [
                [
                    8.4155754002257204e-03,
                    4.4965435985537747e-03,
                    1.2429736855195657e-03,
                ],
                [
                    3.3674051289399750e-03,
                    -2.9461873480444030e-03,
                    -5.1661572025916433e-03,
                ],
                [
                    6.3538505183182608e-04,
                    -1.2516343494965257e-02,
                    1.3743850475191995e-02,
                ],
                [
                    6.3126416977306657e-03,
                    6.0912931302291090e-03,
                    -1.3903631728421025e-02,
                ],
                [
                    -2.1904837218489608e-03,
                    6.2818153015756929e-03,
                    6.2844291295348553e-03,
                ],
                [
                    -6.3879881136752256e-05,
                    -5.4818102062096762e-03,
                    -6.9222928685433519e-03,
                ],
                [
                    -1.7841279085025303e-03,
                    -8.2416706772284816e-04,
                    1.5451307640346962e-03,
                ],
                [
                    -2.8455586356793904e-05,
                    -7.3048283253451601e-04,
                    -5.4936697839413585e-03,
                ],
                [
                    -8.4942840085972806e-04,
                    2.0457096467460397e-03,
                    5.1800909196577651e-04,
                ],
                [
                    1.3178585083681597e-04,
                    4.0824629476097200e-04,
                    -1.9816365631817857e-03,
                ],
                [
                    5.7858009345253122e-05,
                    -2.6324898346975377e-03,
                    8.0278685867221915e-04,
                ],
                [
                    -7.2094464034380421e-03,
                    9.5492789922581849e-03,
                    3.2901804095471919e-03,
                ],
                [
                    2.8745700684434145e-03,
                    -3.1270750680797784e-03,
                    -1.1595480093338293e-03,
                ],
                [
                    2.0398520657357791e-04,
                    -1.8075648880033536e-03,
                    1.3402989883491885e-04,
                ],
                [
                    2.1559040344662642e-03,
                    2.6368297083123812e-03,
                    1.2749200615584811e-03,
                ],
                [
                    -3.3330413042191678e-03,
                    -1.4251887891062354e-03,
                    1.0268982641413859e-03,
                ],
                [
                    7.9474684659929103e-04,
                    -8.3784622153008578e-04,
                    -2.5227229119631654e-03,
                ],
                [
                    -4.2498989149274994e-03,
                    -1.0396928919680529e-02,
                    -1.3691052400019754e-02,
                ],
                [
                    -3.9284222811842530e-03,
                    7.2817427591066056e-03,
                    1.3791491248954032e-02,
                ],
                [
                    2.1443116036104712e-04,
                    6.7215656363470730e-04,
                    1.1296009661371626e-03,
                ],
                [
                    7.7422356579127369e-05,
                    7.8824605762619032e-04,
                    -1.1882148624556060e-03,
                ],
                [
                    -1.3193261203744580e-03,
                    -4.6555460091560126e-04,
                    5.1268699282545492e-04,
                ],
                [
                    1.0693863227636546e-03,
                    -1.0244200673595872e-03,
                    1.5665381084269846e-04,
                ],
                [
                    -4.1281499596160221e-04,
                    2.5649414552594857e-04,
                    2.5238394130220536e-03,
                ],
                [
                    -4.4854605663221690e-03,
                    9.5446725428588470e-03,
                    9.9905657056516793e-03,
                ],
                [
                    7.8043081696015592e-05,
                    -5.3107728350502634e-04,
                    1.9165061389782147e-03,
                ],
                [
                    3.9029715267082841e-04,
                    1.8484317741597576e-03,
                    -6.6510867938439854e-04,
                ],
                [
                    -3.6442456878809796e-03,
                    -8.2337138162021199e-03,
                    -8.1948381582866610e-03,
                ],
                [
                    -5.7610661732061038e-04,
                    -3.5959915394944992e-03,
                    1.9949782181093428e-03,
                ],
                [
                    -5.0689801181151226e-04,
                    2.1068795236019121e-03,
                    -3.5295807162561603e-03,
                ],
                [
                    7.2092346649762547e-03,
                    3.8001388098148174e-03,
                    3.8170655179234473e-03,
                ],
                [
                    2.5527856773103791e-04,
                    2.1733612095568909e-03,
                    -3.3099927193138241e-03,
                ],
                [
                    3.3808580037437481e-04,
                    -3.4049980802706632e-03,
                    2.0318499522473947e-03,
                ],
            ]
        ),
    },
    "C60": {
        "etot": torch.tensor(-1.2673081838911e02),
        "grad": torch.tensor(
            [
                [
                    -1.3624353949504453e-03,
                    -2.3062051567926179e-16,
                    3.4839468637220352e-03,
                ],
                [
                    -4.2101569077728179e-04,
                    -1.2957530603965781e-03,
                    3.4839468637225552e-03,
                ],
                [
                    1.1022333882523263e-03,
                    -8.0081943235110872e-04,
                    3.4839468637228870e-03,
                ],
                [
                    1.1022333882520681e-03,
                    8.0081943235111447e-04,
                    3.4839468637230752e-03,
                ],
                [
                    -4.2101569077706511e-04,
                    1.2957530603976053e-03,
                    3.4839468637226354e-03,
                ],
                [
                    2.4490895677253049e-03,
                    -2.7692349819392146e-03,
                    5.7220089017369889e-04,
                ],
                [
                    3.3905092718984988e-03,
                    -1.4734819215417320e-03,
                    5.7220089017435819e-04,
                ],
                [
                    3.1303072652021408e-03,
                    -6.7266248918276556e-04,
                    1.9346362851255091e-03,
                ],
                [
                    2.0280738769478260e-03,
                    -1.4734819215419476e-03,
                    2.7766676666797939e-03,
                ],
                [
                    1.6070581861708777e-03,
                    -2.7692349819386807e-03,
                    1.9346362851249349e-03,
                ],
                [
                    3.3905092718985474e-03,
                    1.4734819215415915e-03,
                    5.7220089017420640e-04,
                ],
                [
                    2.4490895677249762e-03,
                    2.7692349819389687e-03,
                    5.7220089017357627e-04,
                ],
                [
                    1.6070581861708031e-03,
                    2.7692349819387471e-03,
                    1.9346362851251041e-03,
                ],
                [
                    2.0280738769481504e-03,
                    1.4734819215420050e-03,
                    2.7766676666794747e-03,
                ],
                [
                    3.1303072652020337e-03,
                    6.7266248918289762e-04,
                    1.9346362851255070e-03,
                ],
                [
                    -3.5363959852099003e-04,
                    3.6798968912585537e-03,
                    5.7220089017445642e-04,
                ],
                [
                    -1.8768886775526086e-03,
                    3.1849632632122587e-03,
                    5.7220089017363134e-04,
                ],
                [
                    -2.1370906842482474e-03,
                    2.3841438308606091e-03,
                    1.9346362851247730e-03,
                ],
                [
                    -7.7465528929915426e-04,
                    2.3841438308608090e-03,
                    2.7766676666793610e-03,
                ],
                [
                    3.2757809895473940e-04,
                    3.1849632632121906e-03,
                    1.9346362851255679e-03,
                ],
                [
                    -3.6090705635523886e-03,
                    8.0081943235192361e-04,
                    5.7220089017398599e-04,
                ],
                [
                    -3.6090705635524562e-03,
                    -8.0081943235250734e-04,
                    5.7220089017362755e-04,
                ],
                [
                    -2.9278528660776908e-03,
                    -1.2957530603972583e-03,
                    1.9346362851249803e-03,
                ],
                [
                    -2.5068371752998081e-03,
                    -4.0594971094892421e-16,
                    2.7766676666801768e-03,
                ],
                [
                    -2.9278528660778287e-03,
                    1.2957530603980741e-03,
                    1.9346362851252077e-03,
                ],
                [
                    -1.8768886775516582e-03,
                    -3.1849632632124868e-03,
                    5.7220089017390391e-04,
                ],
                [
                    -3.5363959852092325e-04,
                    -3.6798968912586205e-03,
                    5.7220089017479166e-04,
                ],
                [
                    3.2757809895416341e-04,
                    -3.1849632632126330e-03,
                    1.9346362851249744e-03,
                ],
                [
                    -7.7465528929858754e-04,
                    -2.3841438308612843e-03,
                    2.7766676666800398e-03,
                ],
                [
                    -2.1370906842488827e-03,
                    -2.3841438308604911e-03,
                    1.9346362851248770e-03,
                ],
                [
                    -3.2757809895471419e-04,
                    -3.1849632632127652e-03,
                    -1.9346362851253331e-03,
                ],
                [
                    7.7465528929824266e-04,
                    -2.3841438308609404e-03,
                    -2.7766676666803156e-03,
                ],
                [
                    2.1370906842490128e-03,
                    -2.3841438308603194e-03,
                    -1.9346362851244251e-03,
                ],
                [
                    1.8768886775521012e-03,
                    -3.1849632632120709e-03,
                    -5.7220089017393904e-04,
                ],
                [
                    3.5363959852115489e-04,
                    -3.6798968912584492e-03,
                    -5.7220089017434139e-04,
                ],
                [
                    2.9278528660776162e-03,
                    -1.2957530603977976e-03,
                    -1.9346362851255000e-03,
                ],
                [
                    2.5068371752989824e-03,
                    2.1424173741492469e-16,
                    -2.7766676666796850e-03,
                ],
                [
                    2.9278528660776630e-03,
                    1.2957530603976484e-03,
                    -1.9346362851255349e-03,
                ],
                [
                    3.6090705635524133e-03,
                    8.0081943235123536e-04,
                    -5.7220089017504623e-04,
                ],
                [
                    3.6090705635529073e-03,
                    -8.0081943235085101e-04,
                    -5.7220089017544446e-04,
                ],
                [
                    2.1370906842486091e-03,
                    2.3841438308599820e-03,
                    -1.9346362851245633e-03,
                ],
                [
                    7.7465528929909267e-04,
                    2.3841438308605206e-03,
                    -2.7766676666801694e-03,
                ],
                [
                    -3.2757809895466708e-04,
                    3.1849632632127613e-03,
                    -1.9346362851251934e-03,
                ],
                [
                    3.5363959852176638e-04,
                    3.6798968912584535e-03,
                    -5.7220089017413929e-04,
                ],
                [
                    1.8768886775519232e-03,
                    3.1849632632125605e-03,
                    -5.7220089017383170e-04,
                ],
                [
                    -1.6070581861706167e-03,
                    2.7692349819407997e-03,
                    -1.9346362851241508e-03,
                ],
                [
                    -2.0280738769483829e-03,
                    1.4734819215373317e-03,
                    -2.7766676666805103e-03,
                ],
                [
                    -3.1303072652019773e-03,
                    6.7266248918443708e-04,
                    -1.9346362851253400e-03,
                ],
                [
                    -3.3905092718998176e-03,
                    1.4734819215374213e-03,
                    -5.7220089017386087e-04,
                ],
                [
                    -2.4490895677241539e-03,
                    2.7692349819404918e-03,
                    -5.7220089017332506e-04,
                ],
                [
                    -3.1303072652015158e-03,
                    -6.7266248918440856e-04,
                    -1.9346362851247461e-03,
                ],
                [
                    -2.0280738769486175e-03,
                    -1.4734819215384734e-03,
                    -2.7766676666813204e-03,
                ],
                [
                    -1.6070581861702530e-03,
                    -2.7692349819397112e-03,
                    -1.9346362851235522e-03,
                ],
                [
                    -2.4490895677248300e-03,
                    -2.7692349819403261e-03,
                    -5.7220089017450760e-04,
                ],
                [
                    -3.3905092718996598e-03,
                    -1.4734819215371580e-03,
                    -5.7220089017355643e-04,
                ],
                [
                    -1.1022333882530478e-03,
                    -8.0081943235199159e-04,
                    -3.4839468637224633e-03,
                ],
                [
                    -1.1022333882527279e-03,
                    8.0081943235229788e-04,
                    -3.4839468637229603e-03,
                ],
                [
                    4.2101569077772951e-04,
                    1.2957530603966917e-03,
                    -3.4839468637223141e-03,
                ],
                [
                    1.3624353949508133e-03,
                    -2.1198270054459747e-16,
                    -3.4839468637223540e-03,
                ],
                [
                    4.2101569077845999e-04,
                    -1.2957530603966896e-03,
                    -3.4839468637222161e-03,
                ],
            ]
        ),
    },
    "vancoh2": {"etot": torch.tensor(-3.2295379428673e02), "grad": torch.tensor([0.0])},
}


samples: dict[str, Record] = merge_nested_dicts(mols, refs)
